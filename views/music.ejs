<%- include('partials/header') %>

<!-- NEW: Full-Screen Featured Releases Pyramid Layout -->
<section class="min-h-screen w-full flex flex-col items-center justify-center bg-black py-12 px-4 relative overflow-hidden">
    <h2 class="text-4xl md:text-6xl text-center mb-16 text-gold brand-font z-20">LATEST TRANSMISSION</h2>

    <div class="relative w-full max-w-7xl h-[60vh] md:h-[70vh]">
        
        <!-- 1. The Final Scene (TOP/APEX) -->
        <!-- Link points to specific song ID -->
        <a href="/song/Cem7RZsb7Rw" class="absolute left-1/2 -translate-x-1/2 top-0 w-[80%] max-w-md featured-card z-30 group" style="transition: transform 0.5s;">
            <div class="glass-card p-4 rounded-xl border-4 border-[#F4C430] hover:border-[#D4AF37] transition-all duration-300 shadow-2xl">
                <div class="relative aspect-square">
                    <img 
                        src="https://img.youtube.com/vi/Cem7RZsb7Rw/hqdefault.jpg" 
                        alt="The Final Scene thumbnail" 
                        class="w-full h-full object-cover rounded-lg group-hover:scale-[1.02] transition-transform duration-500"
                    >
                    <div class="absolute inset-0 bg-black/40 group-hover:bg-transparent transition-colors duration-500 flex items-center justify-center">
                        <i class="fas fa-play text-6xl text-white opacity-80 group-hover:opacity-100 group-hover:scale-110 transition-all"></i>
                    </div>
                </div>
                <h3 class="text-2xl font-bold text-center mt-4 text-white group-hover:text-[#F4C430] transition-colors">THE FINAL SCENE</h3>
            </div>
        </a>

        <!-- 2. Hide and Lie (LEFT BASE) -->
        <a href="/song/bXgeFfDlmwU" class="absolute left-[5%] bottom-[10%] w-[40%] max-w-sm featured-card z-20 group" style="transition: transform 0.5s;">
            <div class="glass-card p-3 rounded-lg border border-gray-600 hover:border-[#D4AF37] transition-all duration-300">
                <div class="relative aspect-video">
                    <img 
                        src="https://img.youtube.com/vi/bXgeFfDlmwU/hqdefault.jpg" 
                        alt="Hide and Lie thumbnail" 
                        class="w-full h-full object-cover rounded"
                    >
                    <div class="absolute inset-0 bg-black/50 group-hover:bg-black/20 transition-colors flex items-center justify-center">
                        <i class="fas fa-play text-4xl text-white opacity-70 group-hover:opacity-100"></i>
                    </div>
                </div>
                <h3 class="text-lg font-bold text-center mt-2 text-gray-300 group-hover:text-white">HIDE AND LIE</h3>
            </div>
        </a>

        <!-- 3. Morality and Logic 2 (RIGHT BASE) -->
        <a href="/song/Z-meAox5Jkg" class="absolute right-[5%] bottom-[10%] w-[40%] max-w-sm featured-card z-20 group" style="transition: transform 0.5s;">
            <div class="glass-card p-3 rounded-lg border border-gray-600 hover:border-[#D4AF37] transition-all duration-300">
                <div class="relative aspect-video">
                    <img 
                        src="https://img.youtube.com/vi/Z-meAox5Jkg/hqdefault.jpg" 
                        alt="Morality and Logic 2 thumbnail" 
                        class="w-full h-full object-cover rounded"
                    >
                    <div class="absolute inset-0 bg-black/50 group-hover:bg-black/20 transition-colors flex items-center justify-center">
                        <i class="fas fa-play text-4xl text-white opacity-70 group-hover:opacity-100"></i>
                    </div>
                </div>
                <h3 class="text-lg font-bold text-center mt-2 text-gray-300 group-hover:text-white">MORALITY AND LOGIC 2</h3>
            </div>
        </a>
    </div>
</section>

<!-- COMPLETE DISCOGRAPHY GRID -->
<section class="max-w-7xl mx-auto py-20 px-4">
    <h2 class="text-3xl md:text-5xl text-[#D4AF37] mb-12 border-b border-gray-800 pb-4 brand-font">FULL ARCHIVES</h2>
    
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
        <% songs.forEach(function(song) { 
            // Determine best ID and Image
            const hasVideo = song.youtube_info && song.youtube_info.video_id;
            const songId = hasVideo ? song.youtube_info.video_id : song.spotify_id;
            const thumbnail = hasVideo 
                ? `https://img.youtube.com/vi/${song.youtube_info.video_id}/mqdefault.jpg` 
                : '/images/default-album-art.jpg'; 
        %>
            <div class="glass-card bg-black/40 rounded-xl overflow-hidden hover:bg-black/60 transition-all duration-300 group flex flex-col h-full border border-transparent hover:border-[#D4AF37]/30">
                
                <!-- Thumbnail -->
                <div class="relative aspect-video bg-black">
                    <img src="<%= thumbnail %>" alt="<%= song.name %>" class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity duration-300">
                    
                    <!-- Play Overlay -->
                    <a href="/song/<%= songId %>" class="absolute inset-0 flex items-center justify-center bg-black/20 group-hover:bg-transparent transition-colors">
                        <div class="w-12 h-12 rounded-full bg-[#D4AF37]/90 flex items-center justify-center scale-75 group-hover:scale-100 opacity-0 group-hover:opacity-100 transition-all duration-300 shadow-[0_0_20px_rgba(212,175,55,0.6)]">
                            <i class="fas fa-play text-black ml-1"></i>
                        </div>
                    </a>
                </div>

                <div class="p-5 flex flex-col flex-grow">
                    <h3 class="text-xl font-bold text-white mb-1 group-hover:text-[#D4AF37] transition-colors line-clamp-1" title="<%= song.name %>">
                        <%= song.name %>
                    </h3>
                    
                    <% if (song.album) { %>
                        <p class="text-[#20B2AA] text-xs uppercase tracking-wider mb-3"><%= song.album %></p>
                    <% } %>

                    <!-- Description (Optional, clamped) -->
                    <% if (song.youtube_info && song.youtube_info.description) { %>
                        <p class="text-gray-400 text-sm line-clamp-2 mb-6 flex-grow">
                            <%= song.youtube_info.description %>
                        </p>
                    <% } else { %>
                        <div class="flex-grow"></div>
                    <% } %>

                    <!-- Action Area -->
                    <div class="mt-auto space-y-4">
                        <!-- View Details Button -->
                        <a href="/song/<%= songId %>" class="block w-full text-center border border-[#D4AF37] text-[#D4AF37] hover:bg-[#D4AF37] hover:text-black font-bold py-2 rounded-lg transition-all duration-300 uppercase tracking-wider text-sm">
                            View Transmission
                        </a>

                        <!-- Add to Downloads Button -->
                        <!-- ADDED data attributes for cart logic -->
                        <button class="w-full bg-white text-black font-bold py-3 rounded-lg hover:bg-[#D4AF37] transition-colors duration-300 flex items-center justify-center gap-2 shadow-lg add-to-cart-btn" 
                            data-id="<%= songId %>" 
                            data-name="<%= song.name %>" 
                            data-price="0.99" 
                            data-type="digital">
                            <i class="fas fa-cart-plus"></i> Add to Downloads
                        </button>
                    </div>
                </div>
            </div>
        <% }); %>
    </div>
</section>

<!-- Include Store Logic for Cart functionality -->
<script src="/js/store.js"></script>

<%- include('partials/footer') %>